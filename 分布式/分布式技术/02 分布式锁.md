## Redis分布式锁

- 最普通的方式

添加key值

set order:1:key NK PK ？

加锁 



删key的接口，可以释放锁，使用lua脚本执行

主从架构的情况下，可能导致锁失效



- RedLock算法



## Zookeeper分布式锁

通过创建临时节点，创建成功，获取锁；创建失败，说明锁已经被人拥有，就对临时节点创建一个监听器，监听节点何时被删

通过删除临时节点来释放锁







## Redis与ZK分布式锁区别

redis分布式锁，其实需要自己不断去尝试获取锁，比较消耗性能

 

zk分布式锁，获取不到锁，注册个监听器即可，不需要不断主动尝试获取锁，性能开销较小